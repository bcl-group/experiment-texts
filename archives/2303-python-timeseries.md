---
title: Pythonによる時系列信号処理
author: 西井 淳
fontsize: 12pt
papersize: a4paper
toc: false
titlepage: false
screen: true
fancy: false
listing: true
geometry: width=14cm, height=19cm
---

# Pythonによる時系列信号処理

開発環境にはGoogle Colaboratory，もしくはすでにアカウントを作っている大学のGPUサーバを利用してください。

## バンドパスフィルタを使ってみよう

1. 0Hzから30Hzまで(1Hz毎)の正弦波の総和をとった波形を作りなさい。
2. 1で作った波形に10Hz以上を遮断するローパスフィルタを適用して，
に対して上記ローパスを適用して，フィルタ適用後の波形から高周波成分がなくなっていることを確認しなさい。
ローパスフィルタには\verb|scipy.signal.filtfilt()| と \verb|signal.butter()| を用いること。
3. 透過率を表すグラフ(横軸周波数，縦軸透過率)を作りなさい。


## 移動平均と加算平均

1. sin 関数にノイズを加えた波形を生成しなさい。1周期が100タイムステップとする。
2. **移動平均(平滑化)**: 以下のように，信号`a(t)`に対してある窓幅$\Delta T$で時間平均をとることで，ノイズの影響を小さくする方法を移動平均と呼ぶ。
\begin{align}
  \bar{a}(t)=\frac{1}{\Delta T}\int_{t-\Delta T/2}^{t+\Delta T/2}a(t)dt\notag
\end{align}
    1. 1で生成した信号の移動平均を取りなさい。
    2. 元の波形と，移動平均をとった後の波形について，時間軸の原点をどう対応づけると良いか考え，両者を一つのグラフに重ねて表示しなさい。
    3. 移動平均の窓幅をどの程度にすると，元のsin関数に近い形状を復元できるか検討しなさい。
3. **加算平均**: 
(1)の第$i$周期の信号$a_i(t)$, $(i=1\cdots N)$とする。周期的な信号がノイズに埋もれている場合，以下のように加算平均をとることで原波形に近い波形を取り出すことができる。
\begin{align}
  \bar{a}(t)=\sum_{i=1}^Na_i(t)\notag
\end{align}
    1. (1)で生成したn周期分の信号を，1周期毎のデータに各行に格納した2次元配列(`ndarray`)にしなさい。列数が，1周期のタイムステップ(100)になる。
    2. 加算平均をとり，$n$を大きくすることで，元のsin関数に近づくことを確認しなさい。効果が分かりにくい時には，ノイズを大きくしてみなさい。
4. **規格化 + 可算平均**:
    1. sin 関数にノイズを加えた波形を生成しなさい。ただし，1の場合と異なり，1周期毎に，ランダムに10%程度周期が異なる信号とする。
    2. 前問で作った波形に対して以下の処理をして，ノイズの影響を減らし，(できるだけ)元の波形を取り出しなさい
        1. 移動平均をとる
        2. 極大値か極小値に注目し，1周期毎の時間が同じ長さになるようにリサンプリングする。(1周期毎に元の波形の時間ステップは異なるはずだが，全て100ステップになるようにリサンプリングをする)
        3. 加算平均を行う
